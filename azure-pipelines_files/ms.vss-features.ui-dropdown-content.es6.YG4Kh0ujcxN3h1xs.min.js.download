"use strict";define("VSSUI",["require","exports","react","VSS/Core/Observable","VSS/Core/Util/Accessibility","VSS/Core/Util/String","VSS/Core/TimerManagement"],function(e,t,s,i,o,n,l){var r,a,d,c,p,h,u,m,b,x,f,g,I,v,w,C,D;r=t.ResourcesDropdown={},Object.defineProperty(t,"__esModule",{value:!0}),t.ResourcesDropdown.AnnounceFilterCleared="Filter selection cleared",t.ResourcesDropdown.AnnounceFilterResultCount="Showing {0} filtered items.",t.ResourcesDropdown.AnnounceFinishedLoadingItems="Finished loading items",t.ResourcesDropdown.AnnounceItemCount="Showing {0} items.",t.ResourcesDropdown.AnnounceLoadingItems="Loading items",t.ResourcesDropdown.Close="Close",t.ResourcesDropdown.DropdownClearActionText="Clear",t.ResourcesDropdown.DropdownCalloutRoleDescription="Expanded dropdown",t.ResourcesDropdown.DropdownExpandableRoleDescription="Dropdown",t.ResourcesDropdown.HeaderAriaLabel="Header {0}",t.ResourcesDropdown.Loading="Loading...",t.ResourcesDropdown.NoFilterResults="No items matched the supplied filter",t.ResourcesDropdown.NoItemsFound="No items found",t.ResourcesDropdown.SearchAriaLabel="Search",t.ResourcesDropdown.Searching="Searching...",t.ResourcesDropdown.UseItem='Use "{0}"',function(e){a=t.ComponentsExpandableTextFieldExpandableTextField={},Object.defineProperty(t,"__esModule",{value:!0});let i=1;class o extends s.Component{constructor(e){super(e),this.textFieldElement=s.createRef(),this.expandable=s.createRef(),this.collapse=(()=>{this.expandable.current&&this.expandable.current.collapse()}),this.expand=(()=>{this.expandable.current&&this.expandable.current.expand()}),this.renderCallout=(()=>this.props.renderCallout(this,this.dropdownId,this.props.anchorElement?this.props.anchorElement:this.props.anchorPoint?void 0:this.containerElement.current?this.containerElement.current:void 0,this.props.anchorOffset||{horizontal:0,vertical:0},this.props.anchorOrigin||{horizontal:"end",vertical:"end"},this.props.anchorPoint,this.props.dropdownOrigin||{horizontal:"end",vertical:"start"})),this.dropdownId=e.dropdownId||"dropdown-"+i++,this.containerElement=e.containerRef||s.createRef()}render(){return s.createElement(t.Expandable.Expandable,{disabled:this.props.disabled,expandKey:this.props.expandKey,onCollapse:this.props.onCollapse,onExpand:this.props.onExpand,renderCallout:this.renderCallout,ref:this.expandable},e=>s.createElement(t.FocusWithin.FocusWithin,{onFocus:this.props.onFocus,onBlur:this.props.onBlur},i=>s.createElement("div",{className:t.Util.css(this.props.className,"bolt-expandable-textfield"),onBlur:()=>{this.props.blurDismiss&&this.collapse(),i.onBlur&&i.onBlur()},onFocus:e=>{i.onFocus&&i.onFocus(e),e.target===this.containerElement.current&&this.focus()},onMouseDown:e.onMouseDown,onKeyDown:e.onKeyDown,ref:this.containerElement,role:this.props.editable?"combobox":void 0,"aria-expanded":this.props.editable?e.expanded:void 0,tabIndex:-1},s.createElement(t.TextField.TextField,Object.assign({ariaHasPopup:"dialog"},this.props,{ariaActiveDescendant:e.expanded?this.props.ariaActiveDescendant:void 0,role:this.props.editable?"textbox":void 0,ariaExpanded:this.props.editable?void 0:e.expanded,ariaControls:e.expanded?this.dropdownId:void 0,className:"",onClick:e.onClick,ref:this.textFieldElement,suffixIconProps:this.props.hideDropdownIcon?void 0:{key:"dropdown-icon",className:t.Util.css("bolt-expandable-textfield-icon icon-right",this.props.disabled&&"disabled"),iconName:"ChevronDownMed",onClick:e.onClick,size:"small"}})))))}focus(){this.textFieldElement.current&&this.textFieldElement.current.focus()}select(){this.textFieldElement.current&&this.textFieldElement.current.select()}}t.ComponentsExpandableTextFieldExpandableTextField.ExpandableTextField=o,o.defaultProps={expandKey:[40,13]}}(),d=t.ExpandableTextField={},Object.defineProperty(t,"__esModule",{value:!0}),t.ExpandableTextField.ExpandableTextField=a.ExpandableTextField,function(e){c=t.UtilitiesDropdownSelection={},Object.defineProperty(t,"__esModule",{value:!0});t.UtilitiesDropdownSelection.DropdownSelection=class extends t.List.ListSelection{constructor(){super({selectOnFocus:!1})}};t.UtilitiesDropdownSelection.DropdownMultiSelection=class extends t.List.ListSelection{constructor(){super({alwaysMerge:!0,multiSelect:!0,selectOnFocus:!1})}}}(),function(e){p=t[e]={},Object.defineProperty(t,"__esModule",{value:!0}),t[e].DefaultListBoxWidth=-100;class l extends s.Component{constructor(e){super(e),this.tabbableIndex=-1,this.positions=[],this.count=0,this.table=s.createRef(),this.getItemWidth=(()=>{const{width:e}=this.props;return this.selection.multiSelect&&e&&e>0?e-40:e}),this.loadingChanged=(()=>{if(i.ObservableLike.getValue(this.props.loading))o.announce(r.AnnounceLoadingItems);else{o.announce(r.AnnounceFinishedLoadingItems);const e=this.props.items.length;o.announce(n.format(e>0?n.format(r.AnnounceItemCount,e):r.NoFilterResults),!0)}return!0}),this.searchingChanged=(()=>{if(i.ObservableLike.getValue(this.props.searching))o.announce(r.Searching);else if(!1===i.ObservableLike.getValue(this.props.searching)){const e=this.props.items.length;o.announce(e>0?n.format(r.AnnounceFilterResultCount,e):r.NoFilterResults,!0)}return!0}),this.onItemsChanged=(()=>{const e=m(this.wrappedItems||this.props.items);this.tabbableIndex=-1,this.positions=[],this.count=0;for(const t of e){const e=i.ObservableLike.getValue(t);e&&!h(e)?this.positions.push(-1):(-1===this.tabbableIndex&&this.selection.selectable(this.positions.length)&&(this.tabbableIndex=this.positions.length),this.positions.push(++this.count))}return!0}),this.onActivate=((e,t)=>{this.props.onActivate&&this.props.onActivate(e,t.data)}),this.onSelect=((e,t)=>{this.props.onSelect&&this.props.onSelect(e,t.data)}),this.renderListBoxRow=((e,i,o)=>{const{excludeFocusZone:n,excludeTabStop:l}=this.props,r=m(this.wrappedItems||this.props.items),a=e>0&&2===r[e-1].type?`header-${r[e-1].id}`:o.ariaDescribedBy,d=!n&&this.selection.selectable(e),c=Object.assign(Object.assign({},o),{ariaDescribedBy:a,ariaPosInSet:this.positions[e]>=0?this.positions[e]:null,ariaSetSize:this.positions[e]>=0?this.count:null,excludeTabStop:l||this.tabbableIndex!==e,excludeFocusZone:!d,id:i.id,singleClickActivation:!1,role:2===i.type||3===i.type?"row":this.selection.multiSelect?"menuitemcheckbox":"option"});return s.createElement(t.Observer.Observer,{key:i.id||e,item:i},()=>s.createElement(t.Table.TableRow,{key:i.id||e,index:e,details:c,className:t.Util.css("bolt-list-box-row",2===i.type&&"bolt-list-box-header-row",3===i.type&&"bolt-list-box-divider-row",4===i.type&&"bolt-list-box-loading-row",this.selection.multiSelect&&"bolt-list-box-multi-select-row",2!==i.type&&3!==i.type&&"cursor-pointer",i.disabled&&"bolt-list-box-item-disabled")},this.columns.map((s,o)=>{if(this.selection.multiSelect&&0===o){if(3===i.type||4===i.type)return null;if(2===i.type)return t.Table.renderEmptyCell(e,o)}return s.renderCell(e,o,s,i)})))}),this.renderListBoxCell=((e,t,s,i)=>a(e,t,s,i,this.selection.multiSelect));const{selection:l,renderItem:d,items:p}=this.props;this.selection=l||new c.DropdownSelection,this.columns=this.selection.multiSelect?[new t.Table.ColumnSelect]:[],this.columns.push({id:"text",width:this.getItemWidth(),renderCell:d||this.renderListBoxCell,className:t.Util.css("bolt-list-box-text",this.selection.multiSelect?"bolt-list-box-text-multi-select":"bolt-list-box-text-single-select"),readonly:!0}),this.wrappedItems=u(p),this.onItemsChanged()}componentDidUpdate(){this.props.didUpdate&&this.props.didUpdate()}render(){const{className:e,containerClassName:i,focuszoneProps:o,getUnselectableRanges:n,items:l,loading:a,searching:d,searchResultsLoadingText:c,showItemsWhileSearching:p,width:h}=this.props,u={observableValue:l,filter:this.onItemsChanged},m=this.wrappedItems?new t.UtilitiesProvider.ArrayItemProvider(this.wrappedItems):Array.isArray(l)?new t.UtilitiesProvider.ArrayItemProvider(l):l;return this.columns[this.columns.length-1].width=this.getItemWidth(),s.createElement(t.Observer.ItemsObserver,{getUnselectableRanges:n,items:l,selection:this.selection},s.createElement(t.Observer.Observer,{items:u,loading:{observableValue:a||!1,filter:this.loadingChanged},searching:{observableValue:d||!1,filter:this.searchingChanged}},n=>n.searching&&!p?s.createElement("div",{className:"bolt-list-box-loading",style:{width:h}},s.createElement(t.Spinner.Spinner,{size:"medium",label:c||r.Searching})):s.createElement(t.Table.Table,{className:t.Util.css(e,"bolt-list-box"),columns:this.columns,containerClassName:i,focuszoneProps:o,itemProvider:m,onActivate:this.onActivate,onSelect:this.onSelect,renderRow:this.renderListBoxRow,ref:this.table,role:this.selection.multiSelect?"menu":"listbox",scrollable:!0,singleClickActivation:!1,selection:this.selection,showHeader:!1,showLines:!1,spacerWidth:0})))}scrollIntoView(e,t){if(this.table.current)return this.table.current.scrollIntoView(e,t)}}function a(e,i,o,l,a){return l.render?l.render(e,i,o,l):3===l.type?s.createElement(t.Table.SimpleTableCell,{className:t.Util.css(o.className,l.className,a&&"bolt-list-box-divider-multi-select"),columnIndex:i,colspan:a?2:1,key:l.id,tableColumn:o},s.createElement("div",{className:"bolt-list-box-divider flex-grow"})):4===l.type?s.createElement(b,{columnIndex:i,key:l.id,tableColumn:o,tableItem:l}):s.createElement(t.Table.SimpleTableCell,{className:t.Util.css(o.className,l.className,2===l.type&&"bolt-list-box-header"),columnIndex:i,key:l.id,tableColumn:o},s.createElement("div",{id:2===l.type?`header-${l.id}`:void 0,"aria-label":2===l.type?n.format(r.HeaderAriaLabel,l.text):void 0,className:"bolt-list-box-cell-container"},l&&t.List.renderListCell(l)))}function d(e,t=h){const s=[];let i=-1;for(let o=0;o<e.length;o++)!t(e[o])&&i<0?i=o:t(e[o])&&i>=0&&(s.push({beginIndex:i,endIndex:o-1}),i=-1);return i>=0&&s.push({beginIndex:i,endIndex:e.length-1}),s}function h(e){return 2!==e.type&&3!==e.type&&4!==e.type&&!e.disabled}function u(e){if(Array.isArray(e)&&e.length&&"string"==typeof e[0])return e.map(e=>({id:e,text:e}))}function m(e){return t.UtilitiesProvider.getItemsValue(e)}t[e].ListBox=l,l.defaultProps={getUnselectableRanges:d,width:t[e].DefaultListBoxWidth},t[e].renderListBoxCell=a,t[e].getUnselectableRanges=d,t[e].listBoxItemSelectable=h,t[e].wrapListBoxItems=u,t[e].getListBoxItemsValue=m;class b extends s.Component{componentDidMount(){this.props.onMount&&this.props.onMount()}render(){const{columnIndex:e,tableColumn:i,tableItem:o}=this.props;return s.createElement(t.Table.SimpleTableCell,{className:t.Util.css(i.className,o.className),columnIndex:e,colspan:2,contentClassName:"justify-center",key:e,tableColumn:i},s.createElement("div",{className:"bolt-list-box-loading"},s.createElement(t.Spinner.Spinner,{size:"medium",label:r.Loading})))}}t[e].LoadingCell=b}("ComponentsListBoxListBox"),h=t.ListBox={},Object.defineProperty(t,"__esModule",{value:!0}),t.ListBox.DefaultListBoxWidth=p.DefaultListBoxWidth,t.ListBox.getListBoxItemsValue=p.getListBoxItemsValue,t.ListBox.getUnselectableRanges=p.getUnselectableRanges,t.ListBox.ListBox=p.ListBox,t.ListBox.listBoxItemSelectable=p.listBoxItemSelectable,t.ListBox.LoadingCell=p.LoadingCell,t.ListBox.renderListBoxCell=p.renderListBoxCell,t.ListBox.wrapListBoxItems=p.wrapListBoxItems,function(e){u=t.ComponentsDropdownDropdownCallout={},Object.defineProperty(t,"__esModule",{value:!0});const o=10,l=256,a=16,d=27;t.ComponentsDropdownDropdownCallout.DropdownCallout=function(e){return s.createElement(c,Object.assign({},e))};class c extends s.Component{constructor(e){super(e),this.callout=s.createRef(),this.calloutContent=s.createRef(),this.filterBox=s.createRef(),this.initFocusElement=s.createRef(),this.updateLayout=(()=>(setTimeout(()=>{this.callout.current&&this.callout.current.updateLayout()},0),!0)),this.onMouseDown=(e=>{this.props.ignoreMouseDown&&"INPUT"!==e.target.tagName&&t.Util.preventDefault(e)}),this.listBoxDidUpdate=(()=>{this.getScrollWidth()}),this.getScrollWidth=(()=>{window.requestAnimationFrame(()=>{if(this.calloutContent.current){const e=this.calloutContent.current.offsetWidth-this.props.width;Math.abs(e)>1&&this.setState({scrollBarWidth:e+this.state.scrollBarWidth})}})}),this.state={scrollBarWidth:0}}componentDidMount(){this.getScrollWidth()}focus(){this.filterBox.current?this.filterBox.current.focus():this.initFocusElement.current&&this.initFocusElement.current.focus()}render(){const{actions:e,anchorElement:c,anchorOffset:p,anchorOrigin:u,anchorPoint:m,blurDismiss:b=!0,calloutContentClassName:x,containerClassName:f,contentLocation:g,dropdownOrigin:I,excludeFocusZone:v,excludeTabStop:w,filteredItems:C,filteredNoResultsText:D,filteredResultsLoadingText:E,filterPlaceholderText:F,filterText:S,focusOnMount:O,getUnselectableRanges:T,id:y,items:L,lightDismiss:B,listBoxClassName:P,listBoxRef:N,loading:R,onActivate:M,onFilterTextChanged:U,onSelect:k,renderBeforeContent:V,renderItem:A,searching:j,selection:_,showCloseButton:W,showFilterBox:G,showItemsWhileSearching:H,title:z,updateFilteredItems:K,userFilteredItems:Z}=this.props;let{width:$=l}=this.props;$>0&&($-=this.state.scrollBarWidth);const q=`bolt-dropdown-textfield-${y}`,J=()=>{this.props.onDismiss&&this.props.onDismiss(),S.value="",U&&U(null,""),K&&K()};return s.createElement(t.Callout.Callout,{anchorElement:c,anchorOffset:p,anchorOrigin:u,anchorPoint:m,blurDismiss:b,calloutOrigin:I,contentClassName:t.Util.css(x,"bolt-dropdown flex-column custom-scrollbar v-scroll-auto h-scroll-hidden"),contentLocation:g,contentRef:this.calloutContent,contentShadow:!0,contentSize:3,escDismiss:!0,id:y,lightDismiss:B,focuszoneProps:{postprocessKeyStroke:e=>9!==e.which||e.defaultPrevented?1:(e.preventDefault(),J(),3)},onDismiss:J,role:"menu",ref:this.callout},s.createElement(t.FocusZone.FocusZone,{circularNavigation:!0,defaultActiveElement:G||void 0===G&&L.length>o?t.Util.getSafeIdSelector(q):".bolt-dropdown-init-focus",direction:2,focusOnMount:void 0===O||O},s.createElement("div",{className:"bolt-dropdown-container no-outline",onMouseDown:this.onMouseDown,style:{width:$>=0?$:void 0}},s.createElement("div",{"aria-hidden":"true","aria-roledescription":r.DropdownCalloutRoleDescription,className:"bolt-dropdown-init-focus no-outline",tabIndex:w?void 0:-1,ref:this.initFocusElement,role:"menuitem"}),s.createElement(t.Observer.Observer,{items:{observableValue:L,filter:this.updateLayout}},()=>{const e=void 0===G?L.length>o:G;return e||z||W?s.createElement("div",{className:"bolt-dropdown-header-container"},(z||W)&&s.createElement("div",{className:"bolt-dropdown-header flex-row flex-center"},s.createElement("div",{className:"bolt-dropdown-header-text flex-grow font-weight-semibold"},z),W&&s.createElement(t.Button.Button,{className:"bolt-dropdown-header-button",ariaLabel:r.Close,iconProps:{iconName:"Cancel"},onClick:J,subtle:!0})),e&&s.createElement("div",{key:"bolt-dropdown-filter-container",className:"bolt-dropdown-filter-container"},s.createElement(t.TextField.TextField,{key:"bolt-dropdown-filter",ariaLabel:r.SearchAriaLabel,className:"bolt-dropdown-filter",excludeTabStop:!0,inputId:q,onChange:U,placeholder:F,prefixIconProps:{iconName:"Search"},ref:this.filterBox,value:S,maxWidth:this.props.width-a-d}))):null}),V&&V(),s.createElement(t.Observer.Observer,{filteredItems:C,filteredNoResultsText:D,listBoxItems:{observableValue:L,filter:K},userFilteredItems:{observableValue:Z,filter:K}},e=>{let i=null,o="";return(C&&0===C.length||0===L.length)&&!j&&(o=""===S.value?this.props.noItemsText:n.format(e.filteredNoResultsText||r.NoFilterResults,S.value))&&(i=s.createElement("div",{className:"bolt-dropdown-no-items"},o)),s.createElement(s.Fragment,null,i,s.createElement(h.ListBox,{className:P,containerClassName:t.Util.css("bolt-dropdown-list-box-container",f),didUpdate:this.listBoxDidUpdate,excludeFocusZone:v,excludeTabStop:!0,searchResultsLoadingText:E,focuszoneProps:null,getUnselectableRanges:T,items:C?C.value:L,loading:R,onActivate:M,onSelect:k,renderItem:A,ref:N,searching:j,selection:_,showItemsWhileSearching:H}))}),s.createElement(t.Observer.Observer,{actions:e},e=>{const o=this.props.actions;return o&&o.length?s.createElement("div",{className:"bolt-actions-container flex-column",role:"menubar"},i.ObservableLike.getValue(o).map((e,i)=>s.createElement(t.Button.Button,Object.assign({key:e.id||i,subtle:!0,excludeTabStop:!0,role:"menuitem",ariaRoleDescription:e.role||"button"},e)))):null}))))}}t.ComponentsDropdownDropdownCallout.DropdownCalloutComponent=c,c.defaultProps={width:l,ignoreMouseDown:!0}}(),function(e){function i(e){const{wordBreak:t,whiteSpace:s}=e.style,i=e.clientHeight;e.style.wordBreak="break-all",e.style.whiteSpace="normal";const o=i<e.clientHeight;return e.style.wordBreak=t,e.style.whiteSpace=s,o}m=t.ComponentsDropdownDropdownExpandableTextField={},Object.defineProperty(t,"__esModule",{value:!0}),t.ComponentsDropdownDropdownExpandableTextField.DropdownExpandableTextField=function(e){const{editable:o,expandableRef:n,items:l,inputClassName:a,renderSelectedItems:c,selection:p,showPrefix:h=!0}=e,u=__rest(e,["editable","expandableRef","items","inputClassName","renderSelectedItems","selection","showPrefix"]);let m,b;return o||(b=e.placeholder,p.selectedCount>0&&(b=c(p,l))),h&&1===p.selectedCount&&(m=l[p.value[0].beginIndex].iconProps),s.createElement(d.ExpandableTextField,Object.assign({ariaHasPopup:"menu",ariaRoleDescription:o?void 0:r.DropdownExpandableRoleDescription,autoComplete:o,ariaAutoComplete:o?"list":void 0,focusTreatment:o?0:1,inputType:o?void 0:"button",editable:o,ref:n,value:b},u,{className:t.Util.css(e.className,"bolt-dropdown-expandable-text-field",u.disabled&&"disabled"),inputClassName:t.Util.css(a,"bolt-dropdown-expandable-textfield-input text-ellipsis"),onClick:e=>n.current&&n.current.expand(),prefixIconProps:e.prefixIconProps||m,tooltipProps:Object.assign({text:b,overflowOnly:!0,overflowDetected:i},e.tooltipProps)}))}}(),function(e){b=t[e]={},Object.defineProperty(t,"__esModule",{value:!0});class a extends s.Component{constructor(e){super(e),this.expandable=s.createRef(),this.expandableContainer=s.createRef(),this.filterText=new i.ObservableValue(""),this.collapse=(()=>{this.expandable.current&&this.expandable.current.collapse()}),this.expand=(()=>{this.expandable.current&&this.expandable.current.expand()}),this.onDismiss=(()=>{this.expandable.current&&this.expandable.current.collapse()}),this.onExpand=(()=>{this.props.onExpand&&this.props.onExpand(),this.updateFilteredItems(),this.state.expanded.value=!0}),this.onCollapse=(()=>{this.props.onCollapse&&this.props.onCollapse(),this.state.expanded.value=!1}),this.onActivate=((e,t)=>{e.defaultPrevented||"keydown"!==e.type||(this.state.filteredSelection.multiSelect?this.state.filteredSelection.toggle(this.state.filteredItems.value.indexOf(t),this.state.filteredSelection.alwaysMerge):this.state.filteredSelection.select(this.state.filteredItems.value.indexOf(t),1,this.state.filteredSelection.alwaysMerge),this.onSelect(e,t))}),this.onFilterTextChanged=((e,t)=>{this.filterText.value=t,this.debouncedUpdateFilteredItems()}),this.onSelect=((e,t)=>{const{dismissOnSelect:s,onSelect:i}=this.props,o=this.parentSelection;i&&i(e,t),(void 0!==s?s:o.value.length>0&&!o.multiSelect&&!o.selectOnFocus)&&this.onDismiss()}),this.selectionChanged=((e,t)=>(this.state.filteredSelection.selectionChanged(e,t),!0)),this.renderCallout=((e,t,s,i,o,n,l)=>{const{actions:r,calloutContentClassName:a,containerClassName:d,filterPlaceholderText:c,filteredNoResultsText:p,getUnselectableRanges:h,items:u,loading:m,noItemsText:b,renderItem:x,searching:f,showFilterBox:g,showItemsWhileSearching:I,userFilteredItems:v}=this.props;let w=this.props.width;void 0===w&&this.expandableContainer.current&&(w=this.expandableContainer.current.clientWidth);const{filteredItems:C,filterText:D,filteredSelection:E}=this.state,F={actions:r,anchorElement:s,anchorOffset:i,anchorOrigin:o,anchorPoint:n,calloutContentClassName:a,containerClassName:d,dropdownOrigin:l,filteredItems:C,filteredNoResultsText:p,selection:E,filterPlaceholderText:c,filterText:D,getUnselectableRanges:h,id:t,items:u,loading:m,noItemsText:b,onActivate:this.onActivate,onFilterTextChanged:this.onFilterTextChanged,onDismiss:this.onDismiss,onSelect:this.onSelect,renderItem:x,searching:f,showItemsWhileSearching:I,showFilterBox:g,updateFilteredItems:this.updateFilteredItems,userFilteredItems:v,width:w};return this.props.renderCallout(F)}),this.updateFilteredItems=(()=>(x(this.props,this.state),!0)),this.debouncedUpdateFilteredItems=(()=>{x(this.props,this.state)}),this.parentSelection=e.selection||new c.DropdownSelection;const o=h.wrapListBoxItems(e.items),n=h.getListBoxItemsValue(o||e.items);this.timerManagement=new l.TimerManagement,this.state={expanded:new i.ObservableValue(!1),filteredItems:new i.ObservableArray([...n]),filteredSelection:new t.List.FilteredListSelection(this.parentSelection),filterText:this.filterText,props:e,wrappedItems:o}}static getDerivedStateFromProps(e,t){return e.userFilteredItems===t.props.userFilteredItems&&e.items===t.props.items||x(e,t),Object.assign(Object.assign({},t),{props:e,wrappedItems:h.wrapListBoxItems(e.items)})}componentDidMount(){this.props.filterThrottleWait&&(this.debouncedUpdateFilteredItems=this.timerManagement.debounce(this.debouncedUpdateFilteredItems,this.props.filterThrottleWait))}render(){const{ariaLabel:e,className:i,disabled:o,items:n,placeholder:l,renderExpandable:r,renderSelectedItems:a}=this.props,d={observableValue:this.parentSelection,filter:this.selectionChanged};return s.createElement(t.Observer.ItemsObserver,{getUnselectableRanges:this.props.getUnselectableRanges,items:n,selection:this.parentSelection},s.createElement(t.Observer.Observer,{selection:d},()=>r({ariaLabel:e,className:t.Util.css(i,"bolt-dropdown-expandable"),containerRef:this.expandableContainer,disabled:o,placeholder:l,onCollapse:this.onCollapse,onExpand:this.onExpand,expandableRef:this.expandable,renderCallout:this.renderCallout,items:h.getListBoxItemsValue(this.state.wrappedItems||n),renderSelectedItems:a,selection:this.parentSelection})))}focus(){this.expandable.current&&this.expandable.current.focus()}}function d(e,t){return!(!t.text||2===t.type||3===t.type||4===t.type)&&-1!==t.text.toLowerCase().indexOf(e.toLowerCase())}function p(e,t){const s=t[e.value[0].beginIndex];let i=s&&s.text||"";return e.selectedCount>1&&(i=`${i} (+${e.selectedCount-1})`),i}function x(e,s){const{filteredSelection:l,filterText:a}=s;let d=[];const c=h.getListBoxItemsValue(s.wrappedItems||e.items);let p=c;if(e.userFilteredItems){p=t.UtilitiesProvider.getItemsValue(e.userFilteredItems);const s=e.userFilteredItemsIndexMap&&e.userFilteredItemsIndexMap.value;if(s)d=s;else for(let t=0;t<e.userFilteredItems.length;t++){const e=c.findIndex(e=>e.id===p[t].id);0,d.push(e)}}if(e.filterByText&&a.value){const t=f(p,a.value,d,e.filterItem);p=t.filteredItems,d=t.filteredIndexMap}for(;p.length&&3===p[0].type;)p.shift(),d.shift();if(!i.ObservableLike.getValue(e.searching)&&!i.ObservableLike.getValue(e.loading)&&s.expanded.value)if(a.value){let t=r.NoFilterResults;e.filteredNoResultsText&&(t=i.ObservableLike.getValue(e.filteredNoResultsText)),o.announce(p.length>0?n.format(r.AnnounceFilterResultCount,p.length):t,!0)}else 0===p.length&&e.noItemsText?o.announce(e.noItemsText,!0):p.length>0&&o.announce(n.format(r.AnnounceItemCount,p.length));return l.updateFilteredSelection(d),s.filteredItems.value=p,!0}function f(e,t,s=[],i=d){const o=[],n=[],l=[];if(t){let r,a,d=-1,c=-1;for(let p=0,h=e.length;p<h;p++){const h=e[p],u=s.length?s[p]:p;if(2===h.type)r=h,d=u;else if(3===h.type)a=h,c=u;else{const s=i(t,h,e);(s||4===h.type)&&(a&&a.groupId===h.groupId&&(o.push(a),n.push(c),a=void 0),r&&r.groupId===h.groupId&&(o.push(r),n.push(d),r=void 0),o.push(h),n.push(u),l.push(Array.isArray(s)?s:[]))}}}return{filteredItems:o,filteredIndexMap:n,filterMatches:l}}function g(e,t,i){const o=[];let n=-1;for(let s=0;s<e.length;s++)-1!==t.indexOf(s)?o&&o[o.length-1]&&o[o.length-1].bold?o[n].text+=e.charAt(s):o[++n]={text:e.charAt(s),bold:!0}:o&&o[o.length-1]&&!o[o.length-1].bold?o[n].text+=e.charAt(s):o[++n]={text:e.charAt(s),bold:!1};const l=[];for(let t=0;t<o.length;t++){const i=o[t];i.bold?l.push(s.createElement("span",{className:"font-weight-heavy",key:`${e}-${t}`},i.text)):l.push(i.text)}return s.createElement("span",{className:i},l)}t[e].Dropdown=a,a.defaultProps={filterByText:!0,filterItem:d,getUnselectableRanges:h.getUnselectableRanges,renderCallout:u.DropdownCallout,renderExpandable:m.DropdownExpandableTextField,renderSelectedItems:p},t[e].filterItemByText=d,t[e].renderDropdownSelectedItemText=p,t[e].filterItems=f,t[e].renderHighlightedText=function(e,i,o,l,a){let d=l;return a&&l.text&&(d=Object.assign(Object.assign({},l),{textNode:g(l.text,a)})),s.createElement(t.Table.SimpleTableCell,{className:t.Util.css(o.className,l.className,2===l.type&&"bolt-list-box-header"),columnIndex:i,key:i,tableColumn:o},s.createElement("div",{id:2===l.type?`header-${l.id}`:void 0,"aria-label":2===l.type?n.format(r.HeaderAriaLabel,l.text):void 0},t.List.renderListCell(d)))},t[e].getHighlightedText=g}("ComponentsDropdownDropdown"),function(e){function i(e){const t=e.querySelector(".bolt-dropdown-expandable-button-label");return!!t&&t.scrollWidth>Math.ceil(t.offsetWidth)}x=t.ComponentsDropdownDropdownExpandableButton={},Object.defineProperty(t,"__esModule",{value:!0}),t.ComponentsDropdownDropdownExpandableButton.DropdownExpandableButton=function(e){const{expandableRef:o,items:n,placeholder:l,renderSelectedItems:r,selection:a,tooltipProps:d}=e,c=__rest(e,["expandableRef","items","placeholder","renderSelectedItems","selection","tooltipProps"]);let p=l;return a.selectedCount>0&&(p=r(a,n)),s.createElement(t.Button.ExpandableButton,Object.assign({ref:o},c,{tooltipProps:Object.assign({overflowOnly:!0,overflowDetected:i},e.tooltipProps)}),s.createElement("div",{className:"bolt-dropdown-expandable-button-label justify-start flex-grow text-ellipsis"},e.children,p))}}(),function(e){f=t.UtilitiesDropdownFilter={},Object.defineProperty(t,"__esModule",{value:!0}),t.UtilitiesDropdownFilter.updateFilterToSelection=function(e,s,i,o){const n=[];for(let t=0;t<e.length;t++)for(let i=e[t].beginIndex;i<=e[t].endIndex;i++)n.push(void 0!==s[i].data?s[i].data:s[i].id);const l=i.getFilterItemState(o);let r=!1;(r=l?!t.Util.arrayEquals(l.value,n)&&(n.length||l.value):!!n.length)&&("keyword"===o?i.setFilterItemState(o,{value:n[0]}):i.setFilterItemState(o,{value:n}))}}(),function(e){g=t.ComponentsDropdownDropdownFilterBarItem={},Object.defineProperty(t,"__esModule",{value:!0});const n=256;t.ComponentsDropdownDropdownFilterBarItem.DropdownFilterBarItem=class extends t.FilterBarItem.FilterBarItem{constructor(e){super(e),this.dropdown=s.createRef(),this.selectDefaultFilterItem=(()=>{if(this.props.filter){const e=this.props.filter.getFilterItemState(this.props.filterItemKey);if(e&&e.value){const s=h.getListBoxItemsValue(this.wrappedItems||this.props.items),i=new t.List.ListSelection(this.selection.multiSelect);for(let t=0;t<e.value.length;t++){const o=s.findIndex(s=>s.id===e.value[t]||s.data===e.value[t]);o>-1&&i.select(o,1,!0)}this.selection.value=i.value}}}),this.onFilterChanged=(e=>{super.onFilterChanged(e);const s=h.getListBoxItemsValue(this.wrappedItems||this.props.items);if(e&&e.value){const i=new t.List.ListSelection(this.selection.multiSelect);for(let t=0;t<e.value.length;t++){const o=s.findIndex(s=>s.id===e.value[t]||s.data===e.value[t]);o>-1&&i.select(o,1,!0)}t.UtilitiesSelection.compareSelectionRanges(this.selection.value,i.value).length&&(this.selection.value=i.value)}else this.selection.clear()}),this.onSelectionChanged=(e=>{const t=h.getListBoxItemsValue(this.wrappedItems||this.props.items);return this.props.filter&&f.updateFilterToSelection(e,t,this.props.filter,this.props.filterItemKey),!0}),this.renderExpandableButton=(e=>{const{className:i,renderExpandable:o}=this.props,n=Object.assign(Object.assign({},e),{className:t.Util.css(i,"bolt-dropdown-filter-bar-item"),subtle:!0,renderSelectedItems:this.renderSelectedItems});return o?o(n):s.createElement(x.DropdownExpandableButton,Object.assign({},n))}),this.onClearClick=(()=>{this.selection.clear(),o.announce(r.AnnounceFilterCleared)}),this.renderSelectedItems=((e,t)=>{let i=t[e.value[0].beginIndex].text||"";e.selectedCount>1&&(i=`${i} (+${e.selectedCount-1})`);const o=s.createElement("span",{className:"bolt-dropdown-filter-bar-item-selected-text"},i);return this.props.showPlaceholderAsLabel?s.createElement(s.Fragment,null,s.createElement("span",{className:"bolt-dropdown-filter-bar-item-placeholder"},`${this.props.placeholder}: `),o):o}),this.wrappedItems=h.wrapListBoxItems(e.items),this.selection=e.selection||new c.DropdownSelection,this.selectDefaultFilterItem()}focus(){this.dropdown.current&&this.dropdown.current.focus()}render(){return s.createElement(t.Observer.SelectionObserver,{selection:this.selection,onSelectionChanged:this.onSelectionChanged},()=>{const e=[...i.ObservableLike.getValue(this.props.actions||[])];return this.props.hideClearAction||e.push({className:"bolt-dropdown-action-right-button",disabled:0===this.selection.selectedCount,iconProps:{iconName:"Clear"},text:r.DropdownClearActionText,onClick:this.onClearClick}),s.createElement(t.Observer.Observer,{dropdownItems:{observableValue:this.props.items,filter:this.selectDefaultFilterItem}},()=>s.createElement(b.Dropdown,Object.assign({renderExpandable:this.renderExpandableButton,width:n},this.props,{actions:e,selection:this.selection,ref:this.dropdown})))})}}}(),function(e){I=t.ComponentsDropdownWithPivots={},Object.defineProperty(t,"__esModule",{value:!0}),t.ComponentsDropdownWithPivots.WithPivots=function(e){const o=o=>s.createElement(u.DropdownCallout,Object.assign({},o,e.calloutProps,{onFilterTextChanged:(t,s)=>{o.onFilterTextChanged&&o.onFilterTextChanged(t,s),e.calloutProps&&e.calloutProps.onFilterTextChanged&&e.calloutProps.onFilterTextChanged(t,s)},renderBeforeContent:()=>(function(e){return e.pivots.length<2?null:s.createElement(t.FocusZone.FocusZoneContext.Consumer,null,o=>s.createElement(t.FocusZone.FocusZone,{direction:1},s.createElement("div",{role:"tablist"},s.createElement(t.FocusWithin.FocusWithin,null,n=>e.pivots.map((l,r)=>{const a=void 0!==e.selectedPivot&&l.id===i.ObservableLike.getValue(e.selectedPivot);return s.createElement(t.Button.Button,{ariaSelected:a,ariaSetSize:e.pivots.length,ariaPosInSet:r+1,className:"bolt-dropdown-pivot",key:l.id,subtle:!0,onBlur:n.onBlur,onClick:()=>(function(e,t){t.onPivotClicked&&t.onPivotClicked(e)})(l,e),onFocus:n.onFocus,role:"tab",focusZoneId:0!==r||n.hasFocus?void 0:o.focuszoneId},s.createElement("span",{className:t.Util.css(e.selectedPivot&&l.id===i.ObservableLike.getValue(e.selectedPivot)&&"bolt-dropdown-pivot-selected")},l.name||l.id))})))))})(e)}));return s.createElement(t.Observer.Observer,{selectedPivot:e.selectedPivot},()=>{const n=function(e){let t;if(e.selectedPivot){const s=i.ObservableLike.getValue(e.selectedPivot);t=e.pivots.find(e=>e.id===s)}return t||e.pivots[0]}(e);return s.createElement(t.Observer.Observer,{userFilteredItems:n.userFilteredItems},()=>{const t={actions:n.actions,filterByText:n.filterByText,userFilteredItems:n.userFilteredItems||n.items,filteredNoResultsText:n.filteredNoResultsText,filterPlaceholderText:n.filterPlaceholderText,noItemsText:n.noItemsText,renderCallout:o,showFilterBox:n.showFilterBox};return e.children(t)})})}}(),v=t.Dropdown={},Object.defineProperty(t,"__esModule",{value:!0}),t.Dropdown.Dropdown=b.Dropdown,t.Dropdown.filterItems=b.filterItems,t.Dropdown.filterItemByText=b.filterItemByText,t.Dropdown.getHighlightedText=b.getHighlightedText,t.Dropdown.renderDropdownSelectedItemText=b.renderDropdownSelectedItemText,t.Dropdown.renderHighlightedText=b.renderHighlightedText,t.Dropdown.DropdownCallout=u.DropdownCallout,t.Dropdown.DropdownCalloutComponent=u.DropdownCalloutComponent,t.Dropdown.DropdownExpandableButton=x.DropdownExpandableButton,t.Dropdown.DropdownExpandableTextField=m.DropdownExpandableTextField,t.Dropdown.DropdownFilterBarItem=g.DropdownFilterBarItem,t.Dropdown.WithPivots=I.WithPivots,function(e){w=t[e]={},Object.defineProperty(t,"__esModule",{value:!0});t[e].EditableDropdownItemProvider=class{constructor(e,t){this.itemCollection=new i.ObservableCollection,i.ObservableLike.isObservable(e)?this.listItems=e:this.listItems=new i.ObservableArray(h.wrapListBoxItems(e)||e),this.itemCollection.push(this.listItems),this.extraItem=new i.ObservableArray,this.itemCollection.push(this.extraItem),this.selection=t}get length(){return this.itemCollection.length}get value(){return this.itemCollection.value}get hasExtraItem(){return this.extraItem.length>0}subscribe(e,t){this.itemCollection.subscribe(e,t)}unsubscribe(e,t){return this.itemCollection.unsubscribe(e,t)}setTextValue(s){if(this.hasExtraItem&&this.extraItem.splice(0,1),s){const i=this.listItems.value.findIndex(e=>e.text===s);-1!==i&&this.selection.selectable(i)||this.extraItem.push({id:s,text:n.format(r.UseItem,s),className:t[e].editableDropdownExtraItemClassName})}}},t[e].editableDropdownExtraItemClassName="editable-dropdown-extra-item"}("UtilitiesEditableDropdownItemProvider"),function(e){C=t.ComponentsEditableDropdownCustomEditableDropdown={},Object.defineProperty(t,"__esModule",{value:!0});class o extends s.Component{constructor(e){if(super(e),this.dropdown=s.createRef(),this.listBox=s.createRef(),this.filteredIndexMap=new i.ObservableValue([]),this.filterMatches=[],this.collapse=(()=>{this.dropdown.current&&this.dropdown.current.collapse()}),this.expand=(()=>{this.dropdown.current&&this.dropdown.current.expand()}),this.renderItem=((e,i,o,n)=>s.createElement(t.Observer.Observer,{focusedIndex:{observableValue:this.focusedIndex,filter:()=>{const t=this.filteredIndexMap.value[e];return t===this.focusedIndex.value||t===this.previousFocusedIndex}},key:n.id},()=>{const s=this.filteredIndexMap.value[e]===this.focusedIndex.value?Object.assign(Object.assign({},n),{className:t.Util.css(n.className,"bolt-editable-dropdown-focused-item")}):Object.assign({},n),l=this.filterMatches[e];return!s.render&&l&&l.length&&(s.render=((e,t,s,i)=>b.renderHighlightedText(e,t,s,i,l))),this.props.renderItem(e,i,o,s)})),this.onCollapse=(()=>{const{allowFreeform:e,autoAccept:t,onCollapse:s,onTextChange:o,onValueChange:n,text:l}=this.props;if(s&&s(),!this.selectedItemInList){const e=this.itemProvider.value.findIndex((e,t)=>this.selection.selectable(t)&&e.text===i.ObservableLike.getValue(l||""));e>-1&&this.selectIndex(e)}const r=this.itemProvider.length-1;if(!e||this.selection.value.length&&this.selection.value[0].beginIndex!==r&&this.selectedItemInList||!this.itemProvider.hasExtraItem){if(this.selection.value.length){const e=this.itemProvider.value[this.selection.value[0].beginIndex];n&&n(e)}}else{if(t||this.selectedItemInList){const e=this.itemProvider.value[r].id;n&&n({id:e,text:e})}this.selection.clear()}o&&o(null,""),this.isExpanded=!1,this.selectedItemInList=!1}),this.onItemsChange=((e,t)=>{"change"!==t&&this.filterItems()}),this.onSelect=((e,t)=>{this.selectedItemInList=!0}),this.renderExpandable=(e=>s.createElement(t.Observer.Observer,{focusedIndex:this.focusedIndex,text:this.props.text},t=>{const{onTextChange:s}=this.props,{focusedIndex:i,text:o}=t;let n;i>-1&&this.itemProvider.value[i]&&(n=this.itemProvider.value[i].id);const l=Object.assign(Object.assign({},e),{ariaActiveDescendant:n,editable:!0,showPrefix:!o,blurDismiss:!0,onChange:s,onKeyDown:this.onKeyDown,value:o});return this.props.renderExpandable(l)})),this.renderCallout=(e=>{const t=Object.assign(Object.assign({},e),{focusOnMount:!1,excludeTabStop:!0,excludeFocusZone:!0,ignoreMouseDown:!0,listBoxRef:this.listBox});return this.props.renderCallout(t)}),this.onExpand=(()=>{if(this.props.onExpand&&this.props.onExpand(),this.props.filterItems){const e=this.props.filterItems("",this.itemProvider.value),t=this.updateFilteredIndexMap(e.filteredIndexMap);this.filteredItems.value=e.filteredItems,this.focusItem(t)}else{this.filteredItems.value=this.itemProvider.value;const e=this.updateFilteredIndexMap(this.filteredItems.value.map((e,t)=>t));this.focusItem(e)}this.isExpanded=!0}),this.onValueChange=(()=>{const e=i.ObservableLike.getValue(this.props.text||"");return this.props.allowFreeform&&(this.itemProvider.hasExtraItem&&this.filteredItems.pop(),this.itemProvider.setTextValue(e)),this.filterItems(),!1}),this.filterItems=(()=>{const e=this.itemProvider.value,t=i.ObservableLike.getValue(this.props.text||"");let s;s=this.props.filterItems?this.props.filterItems(t,e):t?v.filterItems(e,t,[],this.props.filterItem):{filteredItems:e,filteredIndexMap:e.map((e,t)=>t),filterMatches:[]},this.filterMatches=s.filterMatches;const o=this.updateFilteredIndexMap(s.filteredIndexMap);this.filteredItems.value=s.filteredItems,this.focusItem(o)}),this.onKeyDown=(e=>{switch(e.which){case 27:this.collapse(),e.preventDefault();break;case 13:this.isExpanded||(this.expand(),e.preventDefault());case 9:this.isExpanded&&!e.shiftKey&&this.filteredItems.length&&(this.selectIndex(this.focusedIndex.value),this.collapse(),e.preventDefault());break;case 38:this.isExpanded&&(this.focusPreviousItem(),this.listBox.current&&this.listBox.current.scrollIntoView(this.filteredIndexMap.value.indexOf(this.focusedIndex.value),{block:"nearest"})),e.preventDefault();break;case 40:this.isExpanded?(this.focusNextItem(),this.listBox.current&&this.listBox.current.scrollIntoView(this.filteredIndexMap.value.indexOf(this.focusedIndex.value),{block:"nearest"})):this.isExpanded||this.expand(),e.preventDefault();break;case 46:case 8:i.ObservableLike.getValue(this.props.text||"")||(this.selection.clear(),this.props.onValueChange&&this.props.onValueChange());break;default:this.expand()}}),this.selection=e.selection||new c.DropdownSelection,this.itemProvider=new w.EditableDropdownItemProvider(e.items,this.selection),this.filteredItems=new i.ObservableArray([...this.itemProvider.value]),this.focusedIndex=new i.ObservableValue(-1),this.previousFocusedIndex=-1,this.timerManagement=new l.TimerManagement,this.filteredIndexMap.value=this.itemProvider.value.map((e,t)=>t),this.props.selectedText){const e=i.ObservableLike.getValue(this.props.selectedText);if(e){const t=this.itemProvider.value.findIndex(t=>t.text===e);t>-1&&this.selection.select(t)}}}render(){const{ariaLabel:e,calloutContentClassName:i,className:o,disabled:n,filterByText:l,getUnselectableRanges:a,noItemsText:d,selectedText:c,text:p}=this.props;return s.createElement(t.Observer.Observer,{text:{observableValue:p,filter:this.onValueChange},items:{observableValue:this.itemProvider,filter:this.onItemsChange},selection:this.selection,selectedText:c},c=>{let p=this.props.placeholder;if(c.selectedText)p=c.selectedText;else if(c.selection.length){const e=c.selection[0].beginIndex;p=this.itemProvider.value[e].text}return s.createElement(v.Dropdown,{ariaLabel:e,calloutContentClassName:i,className:t.Util.css("bolt-editable-dropdown",(c.selection.length>0||!!c.selectedText)&&"bolt-editable-dropdown-with-selection",o),disabled:n,getUnselectableRanges:a,filterByText:l,items:this.itemProvider,noItemsText:d||r.NoItemsFound,onCollapse:this.onCollapse,onExpand:this.onExpand,onSelect:this.onSelect,placeholder:p,ref:this.dropdown,renderCallout:this.renderCallout,renderExpandable:this.renderExpandable,renderItem:this.renderItem,selection:this.selection,showFilterBox:!1,userFilteredItems:this.filteredItems,userFilteredItemsIndexMap:this.filteredIndexMap})})}componentDidMount(){this.props.filterThrottleWait&&(this.filterItems=this.timerManagement.debounce(this.filterItems,this.props.filterThrottleWait))}focus(){this.dropdown.current&&this.dropdown.current.focus()}selectIndex(e){e>-1&&(this.selection.select(e),this.selectedItemInList=!0)}focusItem(e){void 0!==e&&e>-1&&(this.previousFocusedIndex=this.focusedIndex.value,this.focusedIndex.value=e)}updateFilteredIndexMap(e){const t=this.filteredIndexMap.value.indexOf(this.focusedIndex.value);this.filteredIndexMap.value=e;let s=e[t];return(!s||s<0||!this.selection.selectable(s)||-1===this.filteredIndexMap.value.indexOf(s))&&(s=this.filteredIndexMap.value.find(e=>this.selection.selectable(e))),s}focusNextItem(){let e;for(let t=this.filteredIndexMap.value.indexOf(this.focusedIndex.value)+1;t<this.filteredIndexMap.value.length;t++)if(this.selection.selectable(this.filteredIndexMap.value[t])){e=this.filteredIndexMap.value[t];break}this.focusItem(e)}focusPreviousItem(){let e;for(let t=this.filteredIndexMap.value.indexOf(this.focusedIndex.value)-1;t>=0;t--)if(this.selection.selectable(this.filteredIndexMap.value[t])){e=this.filteredIndexMap.value[t];break}this.focusItem(e)}}t.ComponentsEditableDropdownCustomEditableDropdown.CustomEditableDropdown=o,o.defaultProps={autoAccept:!0,renderExpandable:v.DropdownExpandableTextField,renderCallout:v.DropdownCallout,renderItem:h.renderListBoxCell}}(),function(e){D=t.ComponentsEditableDropdownEditableDropdown={},Object.defineProperty(t,"__esModule",{value:!0});t.ComponentsEditableDropdownEditableDropdown.EditableDropdown=class extends s.Component{constructor(e){super(e),this.dropdown=s.createRef(),this.collapse=(()=>{this.dropdown.current&&this.dropdown.current.collapse()}),this.expand=(()=>{this.dropdown.current&&this.dropdown.current.expand()}),this.onTextChange=((e,t)=>{this.props.onTextChange&&this.props.onTextChange(e,t),this.text.value=t}),this.onValueChange=(e=>{this.props.onValueChange&&this.props.onValueChange(e),this.selectedText.value=e&&e.text||""}),this.text=i.ObservableLike.isObservable(e.text)?e.text:new i.ObservableValue(e.text||""),this.selectedText=i.ObservableLike.isObservable(e.selectedText)?e.selectedText:new i.ObservableValue(e.selectedText)}focus(){this.dropdown.current&&this.dropdown.current.focus()}render(){return s.createElement(C.CustomEditableDropdown,Object.assign({},this.props,{onTextChange:this.onTextChange,onValueChange:this.onValueChange,ref:this.dropdown,selectedText:this.selectedText,text:this.text}))}}}(),t.EditableDropdown={},Object.defineProperty(t,"__esModule",{value:!0}),t.EditableDropdown.EditableDropdown=D.EditableDropdown,t.EditableDropdown.CustomEditableDropdown=C.CustomEditableDropdown,function(e){t.UtilitiesAggregateItemProvider={},Object.defineProperty(t,"__esModule",{value:!0});t.UtilitiesAggregateItemProvider.AggregateItemProvider=class extends i.Observable{constructor(){super(...arguments),this.internalCollections=[],this.items=[]}get length(){return this.items.length}get value(){return this.items}get collections(){return this.internalCollections}push(e){let t;if(i.ObservableLike.isObservable(e)){const s=e,o=this.getSubscriber(this.internalCollections.length);t={items:s.value,provider:s,subscriber:o},this.subscriberCount&&i.ObservableLike.subscribe(t.provider,o)}else e.value?t={items:e.value,provider:e}:e.length&&(t={items:e});t&&(this.internalCollections.push(t),t.items.length&&(this.items.push(...t.items),this.subscriberCount&&this.notify({addedItems:t.items,index:this.items.length-t.items.length},"push")))}getItem(e){let t=0;for(;t<this.internalCollections.length&&0+(this.internalCollections[t].provider?this.internalCollections[t].provider.length:this.internalCollections[t].items.length)<e;)t++;if(t<this.internalCollections.length)return this.internalCollections[t].provider&&this.internalCollections[t].provider.getItem?this.internalCollections[t].provider.getItem(e):this.internalCollections[t].items[e]}subscribe(e,t){if(super.subscribe(e,t),1===this.subscriberCount){for(const e of this.internalCollections)e.subscriber&&e.provider&&e.provider.subscribe&&e.provider.subscribe(e.subscriber);const e=[];for(const t of this.internalCollections)e.push(...t.items);this.items.splice(0,this.items.length,...e)}}unsubscribe(e,t){if(super.unsubscribe(e,t),0===this.subscriberCount)for(const e of this.internalCollections)e.subscriber&&e.provider&&e.provider.unsubscribe&&e.provider.unsubscribe(e.subscriber)}getSubscriber(e){return t=>{let s=t.index;for(let t=0;t<e;t++)s+=this.internalCollections[t].items.length;if(t.changedItems)this.items.splice(s,t.changedItems.length,...t.changedItems),this.notify({changedItems:t.changedItems,index:s},"change");else{const e=t.removedItems||[],i=t.addedItems||[];this.items.splice(s,e.length,...i),this.notify({removedItems:e,addedItems:i,index:s},"splice")}}}}}(),function(e){t.UtilitiesGroupedItemProvider={},Object.defineProperty(t,"__esModule",{value:!0});t.UtilitiesGroupedItemProvider.GroupedItemProvider=class{constructor(e,t,s){this.listItems=new i.ObservableArray,this.internalGroups=[...t],this.groupedItems=[[]];for(let e=0;e<this.internalGroups.length;e++)this.groupedItems.push([]);this.addItems(e);for(let e=0;e<this.internalGroups.length;e++)this.internalGroups[e].loading&&this.setGroupLoading(this.internalGroups[e].id,!0,this.internalGroups[e].loadingItem);s&&this.addHeaders(1,this.groups.length),this.manageHeaders=!!s}get groups(){return this.internalGroups}get length(){return this.listItems.length}get value(){return this.listItems.value}subscribe(e,t){this.listItems.subscribe(e,t)}unsubscribe(e,t){return this.listItems.unsubscribe(e,t)}push(...e){return this.addItems(e),e.length}pushGroups(...e){return this.addGroups(this.internalGroups.length,...e),this.internalGroups.length}pop(){const e=this.listItems.pop();return e&&this.removeItems([e]),e}removeAll(e){const t=this.listItems.removeAll(e);return this.removeItems(t,!1),t}splice(e,t,...s){const i=this.listItems.splice(e,t);return this.removeItems(i,!1),this.addItems(s,!0,e),i}change(e,...t){const s=this.listItems.value.slice(e,t.length);return this.removeItems(s,!1),this.addItems(t,!1),this.listItems.change(e,...t),t.length}spliceGroups(e,t,...s){for(let s=0;s<t;s++){const t=e+s+1;if(this.groupedItems.length>t){if(this.removeItems([...this.groupedItems[t]]),this.manageHeaders){const e=this.groupedItems.findIndex(e=>e.length>0);e>0&&3===this.groupedItems[e][0].type&&this.removeItems([this.groupedItems[e][0]])}this.groupedItems.splice(t,1)}}const i=this.internalGroups.splice(e,t);return this.addGroups(e,...s),i}setGroupLoading(e,t,s){let i=this.groups.findIndex(t=>t.id===e);if(i<0)return;i++;const o=this.groupedItems[i],n=o.findIndex(e=>4===e.type);if(!t&&o.length&&n>-1)this.removeItems([o[n]]);else if(t&&-1===n){const t=s||{id:e+"-loading",type:4,groupId:e};this.addItems([t])}this.groups[i-1].loading=t}addHeaders(e,t=1){for(let s=e;s<e+t;s++){let e=this.groups[s-1];if(this.groupedItems[s].length>0){this.groupedItems[s].find(e=>2===e.type)||this.addItems([{id:e.id+"-header",text:e.name||e.id,type:2,groupId:e.id}]),this.groupedItems.some((e,t)=>t<s&&e.length>0)&&!this.groupedItems[s].find(e=>3===e.type)&&this.addItems([{id:e.id+"-divider",type:3,groupId:e.id}]);const t=this.groupedItems.findIndex((e,t)=>t>s&&e.length>0);t>0&&!this.groupedItems[t].find(e=>3===e.type)&&(e=this.groups[t-1],this.addItems([{id:e.id+"-divider",type:3,groupId:e.id}]))}}}addGroups(e,...t){this.internalGroups.splice(e,0,...t);const s=[];for(let i=0;i<t.length;i++){this.groupedItems.splice(e+i+1,0,[]);for(let e=this.groupedItems[0].length-1;e>=0;e--)if(this.groupedItems[0][e].groupId===t[i].id){const t=this.groupedItems[0].splice(e,1)[0];this.listItems.splice(e,1),s.unshift(t)}}this.addItems(s),this.manageHeaders&&this.addHeaders(e+1,t.length);for(let e=0;e<t.length;e++)t[e].loading&&this.setGroupLoading(t[e].id,!0,t[e].loadingItem)}addItems(e,t=!0,s){if(void 0!==s)for(let t=e.length-1;t>=0;t--)this.addItem(e[t],s);else for(let t=0;t<e.length;t++)this.addItem(e[t],s);t&&this.addToListItems()}addToListItems(){const e=[];for(let t=0;t<this.groupedItems.length;t++)e.push(...this.groupedItems[t]);let t,s=0;const i={};for(let o=0;o<e.length;o++)this.listItems.value[s]===e[o]?(s++,t=void 0):void 0!==t?i[t].push(e[o]):(t=s,i[s]=[e[o]]);const o=Object.keys(i);for(let e=o.length-1;e>=0;e--)this.listItems.splice(parseInt(o[e]),0,...i[parseInt(o[e])])}addItem(e,t){let s=0,i=0;const o=e.groupId;void 0!==o&&(s=this.internalGroups.findIndex(e=>e.id===o)+1);for(let e=0;e<s;e++)i+=this.groupedItems[e].length;if(3===e.type)this.groupedItems[s].unshift(e);else if(2===e.type)this.groupedItems[s].length&&3===this.groupedItems[s][0].type?(this.groupedItems[s].splice(1,0,e),i++):this.groupedItems[s].unshift(e);else{let o=this.groupedItems[s].length;void 0!==t&&t>=i&&t<=i+this.groupedItems[s].length?(o=t-i,i=t):void 0!==t&&t<i?o=0:i+=this.groupedItems[s].length,this.groupedItems[s].splice(o,0,e),s>0&&1===this.groupedItems[s].length&&this.manageHeaders&&this.addHeaders(s)}}removeItems(e,t=!0){for(let s=0;s<e.length;s++){let i=0,o=0;const n=e[s].groupId;void 0!==n&&(i=this.internalGroups.findIndex(e=>e.id===n)+1);for(let e=0;e<i;e++)o+=this.groupedItems[e].length;const l=this.groupedItems[i],r=l.indexOf(e[s]);l.splice(r,1),t&&this.listItems.splice(o+r,1)}}}}()},["Resources.Dropdown","Components/ExpandableTextField/ExpandableTextField","ExpandableTextField","Utilities/DropdownSelection","Components/ListBox/ListBox","ListBox","Components/Dropdown/DropdownCallout","Components/Dropdown/DropdownExpandableTextField","Components/Dropdown/Dropdown","Components/Dropdown/DropdownExpandableButton","Utilities/DropdownFilter","Components/Dropdown/DropdownFilterBarItem","Components/Dropdown/WithPivots","Dropdown","Utilities/EditableDropdownItemProvider","Components/EditableDropdown/CustomEditableDropdown","Components/EditableDropdown/EditableDropdown","EditableDropdown","Utilities/AggregateItemProvider","Utilities/GroupedItemProvider"]),document.dispatchEvent(new CustomEvent("scriptLoaded",{cancelable:!1,detail:{id:"ms.vss-features.ui-dropdown-content"}}));