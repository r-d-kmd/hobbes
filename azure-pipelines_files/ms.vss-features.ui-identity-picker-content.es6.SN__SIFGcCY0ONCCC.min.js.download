"use strict";define("VSSUI",["require","exports","react","VSS/Core/Observable","VSS/Core/Util/Promise","VSS/Core/Util/String","VSS/Core/TimerManagement"],function(e,t,s,i,n,o,r){var a,l,d,u,c,p,h,g,m;a=t[m="ResourcesIdentityPicker"]={},Object.defineProperty(t,"__esModule",{value:!0}),t[m].Loading="Loading...",t[m].MultiIdentityPickerPlaceholderText="Add people",t[m].IdentityPickerLoadingText="Loading identities...",t[m].IdentityPickerResultsFoundText="Showing {0} results",t[m].IdentityPickerPlaceholderText="No one selected",t[m].IdentityPickerPlaceholderFocusText="Assign people",t[m].IdentityPickerNoResultsText="No identities found",t[m].IdentityPickerContact="Contact",t[m].IdentityPickerStartChat="Start chat",t[m].IdentityPickerOrganization="Organization",t[m].IdentityPickerReportingTo="Reporting to {0} ({1})",t[m].IdentityPickerReportsTo="Reports to",t[m].IdentityPickerProfileCardAriaLabel="Contact card",t[m].IdentityPickerProfileCardButtonTooltip="Show Contact Card",t[m].IdentityPickerHeaderButtonLabel="Go back",t[m].IdentityPickerContactInfo="Contact information",t[m].IdentityPickerEmail="Email",t[m].IdentityPickerPhoneNumber="Phone number",t[m].IdentityPickerLocation="Location",t[m].IdentityPickerTitle="Title",t[m].IdentityPickerDepartment="Department",t[m].IdentityPickerAlias="Alias",t[m].Clear="Clear",t[m].UnknownUserOrGroup="Unknown user or group: {0}",function(e){function s(e){return e&&e.entityType&&"user"===e.entityType.toLocaleLowerCase()}function i(e){return e&&e.entityType&&"group"===e.entityType.toLocaleLowerCase()}function n(e){return e&&e.entityType&&"github"===e.originDirectory.toLocaleLowerCase()}l=t[e]={},Object.defineProperty(t,"__esModule",{value:!0}),t[e].getScopedGroupParts=function(e){if(i(e)){const t=e.displayName;if(t&&"["===t[0]){const e=t.indexOf("]\\");if(e>0)return{name:t.substr(e+2),scope:t.substr(0,e+1)}}}},t[e].getSignInAddress=function(e){return e?n(e)?e.mailNickname:!e.isHosted&&e.samAccountName&&e.samAccountName.trim()?(e.scopeName&&e.scopeName.trim()?e.scopeName+"\\":"")+e.samAccountName:e.signInAddress&&e.signInAddress.trim()?e.signInAddress:e.mail&&e.mail.trim()?e.mail:e.mailNickname&&e.mailNickname.trim()?e.mailNickname:"":""},t[e].isUser=s,t[e].isGroup=i,t[e].isGithubUser=n,t[e].shouldShowIdentityCard=function(e){return e&&(s(e)||i(e)||n(e))}}("ComponentsIdentityPickerDropdownIdentityPickerUtils"),function(e){d=t[e]={},Object.defineProperty(t,"__esModule",{value:!0});t[e].IdentityPickerSuggestionItem=class extends s.Component{constructor(){super(...arguments),this.contactCardButtonRef=s.createRef()}render(){const e=this.props.item;let i=l.getSignInAddress(e),n=e.displayName;const o=l.getScopedGroupParts(e);return o&&(n=o.name,i||(i=o.scope)),s.createElement("div",{className:"bolt-picker-suggesteditem flex-row flex-grow flex-center scroll-hidden"},this.props.renderSuggestion&&"custom"===e.entityType?this.props.renderSuggestion(this.props):s.createElement("div",{className:"bolt-picker-suggesteditem-text flex-row flex-grow flex-center text-ellipsis"},s.createElement(t.Persona.Persona,{ariaHidden:!0,className:"bolt-picker-persona text-ellipsis",identity:e,size:24}),s.createElement("div",{className:"bolt-picker-persona-name flex-column flex-grow"},n&&s.createElement(t.TooltipEx.Tooltip,{text:e.displayName,overflowOnly:e.displayName===n},s.createElement("div",{className:"fontSizeM text-ellipsis"},n)),i?s.createElement("div",{className:"flex-row"},l.isGithubUser(e)&&s.createElement(t.Icon.Icon,{className:"bolt-identitypicker-github-icon flex-row flex-center justify-center",iconName:"GitHubLogo"}),s.createElement("div",{className:"fontSize secondary-text text-ellipsis"},i)):void 0)),!!this.props.onOpenPersonaCard&&l.shouldShowIdentityCard(e)&&s.createElement(t.Button.Button,{ariaLabel:a.IdentityPickerProfileCardButtonTooltip,className:"bolt-contact-card-button flex-noshrink",iconProps:{iconName:"ContactCard",className:"flex-shrink"},onClick:t=>{this.props.onOpenPersonaCard&&this.props.onOpenPersonaCard(e),t.preventDefault()},onBlur:this.props.onBlur,onFocus:this.props.onFocus,ref:this.contactCardButtonRef,subtle:!0,tooltipProps:{text:a.IdentityPickerProfileCardButtonTooltip,showOnFocus:!0}}))}focus(){this.contactCardButtonRef.current&&this.contactCardButtonRef.current.focus()}}}("ComponentsIdentityPickerSuggestionsListIdentityPickerSuggestionItem"),function(e){u=t.ComponentsIdentityPickerIdentityPicker={},Object.defineProperty(t,"__esModule",{value:!0});t.ComponentsIdentityPickerIdentityPicker.IdentityPicker=class extends s.Component{constructor(e){super(e),this.emailRegex=RegExp("^[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$","i"),this.resolveEmailPromises=[],this.itemRefs={},this.tagPickerRef=s.createRef(),this.openedIdentityCard=new i.ObservableValue(void 0),this.outerElement=s.createRef(),this.lastSearchVal="",this.suggestions=new i.ObservableArray([]),this.suggestionsLoading=new i.ObservableValue(!1),this.areTagsEqual=((e,t)=>e.entityId===t.entityId),this.renderSuggestionItem=(e=>s.createElement("div",{className:"flex-row flex-grow",onKeyDown:this.onKeyDownSuggestionItem},s.createElement(d.IdentityPickerSuggestionItem,Object.assign({},e,{onOpenPersonaCard:this.onOpenPersonaCard,ref:t=>this.itemRefs[e.item.entityId]=t,renderSuggestion:this.props.renderCustomIdentitySuggestion&&this.renderCustomSuggestionItem})))),this.onKeyDownSuggestionItem=(e=>{e.defaultPrevented||37!==e.which&&27!==e.which&&9!==e.which||this.tagPickerRef.current&&(this.tagPickerRef.current.focus(),e.preventDefault())}),this.createDefaultItem=(e=>({displayName:e,originDirectory:"email",originId:e,entityId:e,entityType:"custom"})),this.onOpenPersonaCard=(e=>{l.shouldShowIdentityCard(e)&&(this.openedIdentityCard.value=e)}),this.onClosePersonaCard=(()=>{this.openedIdentityCard.value=void 0,this.tagPickerRef.current.focus()}),this.shouldBlurClear=(()=>void 0===this.openedIdentityCard.value),this.onEmptyInputFocus=(()=>{this.updateSuggestionsList(this.props.pickerProvider.onEmptyInputFocus())}),this.focusContactCardButton=(e=>{this.itemRefs[e.entityId]&&this.itemRefs[e.entityId].focus()}),this.onAddIdentity=(e=>{this.props.pickerProvider.addIdentitiesToMRU&&this.props.pickerProvider.addIdentitiesToMRU([e]),this.props.onIdentityAdded(e)}),this.onDelimitedSearch=(e=>{e.map(e=>e.trim()).filter(e=>this.emailRegex.test(e)&&!i.ObservableLike.getValue(this.props.selectedIdentities).some(t=>t.entityId===e)).forEach(e=>{this.props.onIdentityAdded(this.createDefaultItem(e)),this.updateResolvedEmail(this.props.pickerProvider.onFilterIdentities(e),e)}),this.tagPickerRef.current&&this.tagPickerRef.current.clearTagPicker()}),this.renderCustomSuggestionItem=(e=>this.props.renderCustomIdentitySuggestion&&this.props.renderCustomIdentitySuggestion(e.item)),this.convertItemToPill=((e,i)=>{const n="email"===e.originDirectory;return this.props.convertItemToPill&&"custom"===e.entityType?this.props.convertItemToPill(e,i):{className:"bolt-identity-picker-pill flex-row",content:n?s.createElement(t.TooltipEx.Tooltip,{text:o.format(a.UnknownUserOrGroup,e.displayName)},s.createElement("div",{className:"bolt-identity-picker-unresolved-email"},e.displayName)):e.displayName||e.mailNickname,onRenderFilledVisual:n?void 0:()=>s.createElement(t.Persona.Persona,{ariaLabel:"",className:"flex-row flex-center",identity:e,size:20})}}),this.onResolveSuggestions=(e=>{this.lastSearchVal=e;const t=this.props.pickerProvider.onFilterIdentities(e,i.ObservableLike.getValue(this.props.selectedIdentities));null!==t&&(this.cachedResults[e]?this.suggestions.value=this.cachedResults[e].filter(e=>!i.ObservableLike.getValue(this.props.selectedIdentities).some(t=>t.entityId===e.entityId)):this.updateSuggestionsList(t,e))}),this.cachedResults={}}render(){return s.createElement("div",{className:this.props.className,ref:this.outerElement},s.createElement(t.Observer.Observer,{openedIdentityCard:this.openedIdentityCard},e=>s.createElement(s.Fragment,null,s.createElement(t.TagPicker.TagPicker,{suggestionsLoading:this.suggestionsLoading,areTagsEqual:this.areTagsEqual,convertItemToPill:this.convertItemToPill,deliminator:this.props.onResolveEmail&&";",noResultsFoundText:a.IdentityPickerNoResultsText,onBlur:this.props.onBlur,onDelimitedSearch:this.props.onResolveEmail&&this.onDelimitedSearch,onEmptyInputFocus:this.onEmptyInputFocus,onSearchChanged:this.onResolveSuggestions,onSuggestionExpanded:this.focusContactCardButton,onTagAdded:this.onAddIdentity,onTagRemoved:this.props.onIdentityRemoved,onTagsRemoved:this.props.onIdentitiesRemoved,placeholderText:this.props.placeholderText||a.MultiIdentityPickerPlaceholderText,prefixIconProps:{className:"bolt-identity-picker-contact-icon secondary-text justify-center flex-center",iconName:"Contact",size:"medium"},ref:this.tagPickerRef,renderSuggestionItem:this.renderSuggestionItem,shouldBlurClear:this.shouldBlurClear,selectedTags:this.props.selectedIdentities,suggestions:this.suggestions,suggestionsLoadingText:a.Loading}),e.openedIdentityCard&&s.createElement(t.IdentityCard.IdentityCard,{getEntityFromUniqueAttribute:this.props.pickerProvider.getEntityFromUniqueAttribute,key:e.openedIdentityCard.entityId,identity:e.openedIdentityCard,displayName:e.openedIdentityCard.displayName,target:this.outerElement.current,onDismissCallback:this.onClosePersonaCard,onRequestConnectionInformation:this.props.pickerProvider.onRequestConnectionInformation}))))}componentWillUnmount(){this.currentPromise&&this.currentPromise.cancel();for(const e of this.resolveEmailPromises)e.cancel()}updateResolvedEmail(e,t){const s=e,o=e;Array.isArray(s)?this.props.onResolveEmail&&1===s.length&&this.props.onResolveEmail(t,i.ObservableLike.getValue(this.props.selectedIdentities).some(e=>e.entityId===s[0].entityId)?null:s[0]):o&&o.then&&(this.currentPromise=n.makeCancelable(o)).promise.then(e=>{this.props.onResolveEmail&&1===e.length&&this.props.onResolveEmail(t,i.ObservableLike.getValue(this.props.selectedIdentities).some(t=>t.entityId===e[0].entityId)?null:e[0])})}updateSuggestionsList(e,t){const s=e,o=e;if(Array.isArray(s))this.suggestions.value=s.filter(e=>!i.ObservableLike.getValue(this.props.selectedIdentities).some(t=>t.entityId===e.entityId));else if(o&&o.then){this.suggestionsLoading.value=!0;const e=this.currentPromise=n.makeCancelable(o);this.resolveEmailPromises.push(e),e.promise.then(s=>{this.resolveEmailPromises=this.resolveEmailPromises.filter(t=>t!==e),e===this.currentPromise&&(t&&this.lastSearchVal!==t||(this.suggestions.value=s.filter(e=>!i.ObservableLike.getValue(this.props.selectedIdentities).some(t=>t.entityId===e.entityId))),t&&""!==t&&this.suggestions.value&&this.suggestions.value.length>0&&(this.cachedResults[t]=s),this.suggestionsLoading.value=!1)},()=>{this.resolveEmailPromises=this.resolveEmailPromises.filter(t=>t!==e)})}}}}(),function(e){c=t[e]={},Object.defineProperty(t,"__esModule",{value:!0});t[e].IdentityPickerSuggestionsList=class extends s.Component{constructor(){super(...arguments),this.renderNoIdentitiesFound=(()=>s.createElement("div",{className:"bolt-identitypickerdropdown-noresults flex-row flex-grow flex-center"},this.props.noResultsFoundText||a.IdentityPickerNoResultsText))}render(){return s.createElement(s.Fragment,null,s.createElement(t.Observer.Observer,{suggestionsVisible:this.props.suggestionsVisible,suggestionsLoading:this.props.isLoading,selectedIndex:this.props.selectedIndex,suggestions:this.props.suggestions},e=>e.suggestionsVisible?s.createElement(t.Callout.Callout,Object.assign({},this.props.calloutProps,{className:t.Util.css("bolt-identitypickerdropdown-callout",this.props.calloutProps.className),contentClassName:t.Util.css("bolt-identitypickerdropdown-callout-content flex-row flex-grow",this.props.calloutProps.contentClassName)}),s.createElement(t.SuggestionsList.SuggestionsList,Object.assign({},this.props,{className:t.Util.css("bolt-identitypickerdropdown-list",this.props.className),isLoading:e.suggestionsLoading,loadingText:this.props.loadingText||a.IdentityPickerLoadingText,renderNoResultFound:this.renderNoIdentitiesFound,renderSuggestion:this.props.renderSuggestion,onBlur:this.props.onBlur,onFocus:this.props.onFocus,resultsMaximumNumber:25,suggestionsItemClassName:t.Util.css("bolt-identitypickerdropdown-item",this.props.suggestionsItemClassName),suggestions:e.suggestions,selectedIndex:e.selectedIndex,width:this.props.width}))):s.createElement("div",null)),s.createElement(t.Observer.Observer,{openedIdentityCard:this.props.openedIdentityCard},e=>e.openedIdentityCard?s.createElement(t.IdentityCard.IdentityCard,{getEntityFromUniqueAttribute:this.props.pickerProvider.getEntityFromUniqueAttribute,key:e.openedIdentityCard.entityId,identity:e.openedIdentityCard,target:this.props.suggestionTarget,onDismissCallback:this.props.onClosePersonaCard,onRequestConnectionInformation:this.props.pickerProvider.onRequestConnectionInformation}):s.createElement("div",null)))}}}("ComponentsIdentityPickerSuggestionsListIdentityPickerSuggestionsList"),function(e){p=t[e]={},Object.defineProperty(t,"__esModule",{value:!0});t[e].CustomIdentityPickerDropdown=class extends s.Component{constructor(e){super(e),this.focusWithin=s.createRef(),this.inputElement=s.createRef(),this.itemRefs={},this.openedIdentityCard=new i.ObservableValue(void 0),this.outerElement=s.createRef(),this.suggestionsLoading=new i.ObservableValue(!1),this.isEditing=new i.ObservableValue(!1),this.selectedIndex=new i.ObservableValue(-1),this.suggestions=new i.ObservableArray([]),this.onPickerDismiss=(()=>{this.props.onSuggestionsVisibleChanged(!1)}),this.renderSuggestionItem=(e=>s.createElement("div",{className:"flex-row flex-grow scroll-hidden",onKeyDown:this.onKeyDownSuggestionItem},s.createElement(d.IdentityPickerSuggestionItem,Object.assign({},e,{onOpenPersonaCard:this.openPersonaCard,ref:t=>this.itemRefs[e.item.entityId]=t,renderSuggestion:this.props.renderCustomIdentitySuggestion&&this.renderCustomSuggestionItem})))),this.renderCustomSuggestionItem=(e=>this.props.renderCustomIdentitySuggestion&&this.props.renderCustomIdentitySuggestion(e.item)),this.renderPersonaCoin=(e=>s.createElement(t.Observer.Observer,{selectedIdentity:this.props.value,isEditing:this.isEditing},i=>i.selectedIdentity&&!i.isEditing?s.createElement(t.Persona.Persona,{className:t.Util.css("flex-row flex-center justify-center",e),identity:i.selectedIdentity,size:24}):s.createElement(t.Icon.Icon,{className:t.Util.css("flex-row flex-center justify-center",e),iconName:"Contact",size:"medium"}))),this.openPersonaCard=(e=>{l.shouldShowIdentityCard(e)&&(this.openedIdentityCard.value=e)}),this.closePersonaCard=(()=>{this.openedIdentityCard.value=void 0,this.inputElement.current&&this.inputElement.current.focus()}),this.completeSuggestion=(()=>{let e;this.suggestions.value.length>0&&i.ObservableLike.getValue(this.props.suggestionsVisible)&&-1!==this.selectedIndex.value?e=this.suggestions.value[this.selectedIndex.value]:(this.selectedIndex.value=-1,e=this.props.resolveUnrecognizedIdentity&&this.props.resolveUnrecognizedIdentity(i.ObservableLike.getValue(this.props.textValue))),this.selectedPersonaChanged(e),e&&this.props.onSuggestionsVisibleChanged(!1)}),this.onBlur=(()=>{this.props.onSuggestionsVisibleChanged(!1),this.openedIdentityCard.value||(""===i.ObservableLike.getValue(this.props.textValue)&&this.selectedPersonaChanged(),this.props.onBlur&&this.props.onBlur())}),this.onClearClicked=(e=>{this.props.onClear&&this.props.onClear(),this.props.onChange(void 0),this.lastPickedIdentity=void 0,this.suggestions.value=[],e.preventDefault()}),this.onClick=(()=>{""===i.ObservableLike.getValue(this.props.textValue)&&this.props.pickerProvider.onEmptyInputFocus||i.ObservableLike.getValue(this.props.value)&&0===this.suggestions.length?(this.updateSuggestionsList(this.props.pickerProvider.onEmptyInputFocus()),this.props.onSuggestionsVisibleChanged(!i.ObservableLike.getValue(this.props.suggestionsVisible))):this.props.onSuggestionsVisibleChanged(!i.ObservableLike.getValue(this.props.suggestionsVisible)),this.inputElement.current.select()}),this.onFocus=(e=>{const{onFocus:t}=this.props;""===i.ObservableLike.getValue(this.props.textValue)&&this.props.pickerProvider.onEmptyInputFocus&&!i.ObservableLike.getValue(this.props.suggestionsVisible)&&this.updateSuggestionsList(this.props.pickerProvider.onEmptyInputFocus()),t&&t(e)}),this.onKeyDown=(e=>{if(e.isDefaultPrevented())return;const t=e.which,s=i.ObservableLike.getValue(this.props.suggestionsVisible),n=this.inputElement.current&&this.inputElement.current.inputElement.current;switch(t){case 27:this.openedIdentityCard.value&&(!this.suggestions.value||!this.suggestions.value[this.selectedIndex.value])&&this.selectedPersonaChanged(),s&&(this.props.onSuggestionsVisibleChanged(!1),this.openedIdentityCard.value=void 0);break;case 9:case 13:!e.shiftKey&&s?(this.completeSuggestion(),e.preventDefault(),e.stopPropagation()):s?this.completeSuggestion():13===t&&n&&!n.value&&this.selectedPersonaChanged(void 0);break;case 39:this.suggestions.value&&this.suggestions.value[this.selectedIndex.value]&&n&&n.value.length===n.selectionEnd&&(this.focusContactCardButton(this.suggestions.value[this.selectedIndex.value]),e.preventDefault());break;case 38:s&&this.suggestions.value&&(this.selectedIndex.value=Math.max(0,this.selectedIndex.value-1),this.forceUpdate(),e.preventDefault(),e.stopPropagation());break;case 40:s&&this.suggestions.value?(this.selectedIndex.value=Math.min(this.suggestions.value.length-1,this.selectedIndex.value+1),this.forceUpdate(),e.preventDefault(),e.stopPropagation()):this.props.onSuggestionsVisibleChanged(!0)}}),this.onKeyDownSuggestionItem=(e=>{e.defaultPrevented||37!==e.which&&27!==e.which&&9!==e.which||this.inputElement.current&&(this.inputElement.current.focus(),e.preventDefault())}),this.focusContactCardButton=(e=>{this.itemRefs[e.entityId]&&this.itemRefs[e.entityId].focus()}),this.onResolveSuggestions=(e=>{const t=this.props.pickerProvider.onFilterIdentities(e,[]);null!==t&&this.updateSuggestionsList(t,e)}),this.onSearchChange=((e,t)=>{if(0==t.length){const{onClear:e}=this.props;e&&e()}this.selectedIndex.value=-1,this.isEditing.value=!0,this.props.onInputChange(t),this.updateValue(t)}),this.onSuggestionClick=(e=>{this.selectedIndex.value=e.index,this.selectedPersonaChanged(e.item),this.props.onSuggestionsVisibleChanged(!1)}),this.onTextFieldChanged=((e,t)=>{this.setState({width:Math.max(e,296)})}),this.selectedPersonaChanged=(e=>{this.lastPickedIdentity!==e&&(e&&this.props.pickerProvider.addIdentitiesToMRU&&this.props.pickerProvider.addIdentitiesToMRU([e]),!1!==this.props.onChange(e)?(this.props.onInputChange(e?e.displayName:""),this.lastPickedIdentity=e):(this.props.onInputChange(""),this.props.onChange(void 0),this.lastPickedIdentity=void 0)),this.isEditing.value=!1}),this.updateValue=(e=>{this.props.onSuggestionsVisibleChanged(!!e),this.cachedResults[e]?this.updateSuggestionsList(this.cachedResults[e],e):this.onResolveSuggestions(e)}),this.cachedResults={},this.timerManagement=new r.TimerManagement,this.lastPickedIdentity=i.ObservableLike.getValue(e.value),this.state={width:296}}render(){const{autoFocus:e,disabled:i,editPlaceholder:n=a.IdentityPickerPlaceholderFocusText,placeholder:o=a.IdentityPickerPlaceholderText}=this.props;return s.createElement(t.Observer.Observer,{suggestionsVisible:this.props.suggestionsVisible},r=>s.createElement(t.FocusWithin.FocusWithin,{onBlur:this.onBlur,onFocus:this.onFocus,ref:this.focusWithin},a=>s.createElement(s.Fragment,null,s.createElement(t.Observer.Observer,{selectedIdentity:this.props.value,selectedIndex:this.selectedIndex,suggestionsLoading:this.suggestionsLoading,textValue:this.props.textValue},l=>{let d;r.suggestionsVisible&&(d=-1===l.selectedIndex||l.suggestionsLoading?"sug-list-transition":this.suggestions&&this.suggestions.length?`sug-row-${l.selectedIndex}`:"sug-list-no-results");const u=r.suggestionsVisible?"tag-picker-callout":void 0,c=a.hasFocus||l.selectedIdentity?n:o;return s.createElement(t.Measure.Measure,{onMeasure:this.onTextFieldChanged},s.createElement("div",{className:"bolt-identitypickerdropdown flex-row flex-grow",ref:this.outerElement,onKeyDown:this.onKeyDown,role:"combobox","aria-expanded":r.suggestionsVisible},s.createElement(t.TextField.TextField,{ariaActiveDescendant:d,ariaAutoComplete:"list",ariaControls:u,autoFocus:e,ariaHasPopup:"listbox",ariaLabel:""===l.textValue?c:l.textValue,className:t.Util.css(this.props.className,"bolt-identitypickerdropdown-textField flex-row flex-center",a.hasFocus&&"bolt-identitypickerdropdown-open"),containerClassName:"bolt-identitypickerdropdown-container flex-column flex-grow",onBlur:a.onBlur,onChange:this.onSearchChange,onClick:this.onClick,onFocus:a.onFocus,prefixIconProps:{render:this.renderPersonaCoin},placeholder:c,ref:this.inputElement,role:"textbox",suffixIconProps:l.textValue&&!i?{iconName:"Clear",className:"bolt-identity-picker-clearButton fontSize",onClick:this.onClearClicked}:void 0,value:l.textValue,disabled:i})))}),s.createElement(t.Observer.Observer,{openedIdentityCard:this.openedIdentityCard,selectedIndex:this.selectedIndex},e=>s.createElement(c.IdentityPickerSuggestionsList,{calloutProps:{anchorElement:this.outerElement.current,anchorOrigin:{horizontal:"start",vertical:"end"},calloutOrigin:{horizontal:"start",vertical:"start"},contentShadow:!0,id:"tag-picker-callout",onDismiss:this.onPickerDismiss,role:"presentation"},suggestionsVisible:r.suggestionsVisible||!!e.openedIdentityCard,isLoading:this.suggestionsLoading,onBlur:a.onBlur,onFocus:a.onFocus,onSuggestionClicked:this.onSuggestionClick,onClosePersonaCard:this.closePersonaCard,onDismiss:this.onPickerDismiss,onOpenPersonaCard:this.openPersonaCard,openedIdentityCard:e.openedIdentityCard,pickerProvider:this.props.pickerProvider,renderSuggestion:this.renderSuggestionItem,suggestions:this.suggestions,suggestionTarget:this.outerElement.current,selectedIndex:e.selectedIndex,width:this.state.width})))))}componentDidMount(){this.updateValue=this.timerManagement.debounce(this.updateValue,250),this.props.autoFocus&&(i.ObservableLike.getValue(this.props.textValue),this.props.pickerProvider.onEmptyInputFocus,this.updateSuggestionsList(this.props.pickerProvider.onEmptyInputFocus()),this.inputElement.current&&this.inputElement.current.select(),this.props.onSuggestionsVisibleChanged(!0)),this.setState({width:this.outerElement.current.clientWidth})}componentWillUnmount(){this.currentPromise&&this.currentPromise.cancel()}updateSuggestionsList(e,t){const s=e,i=e;if(Array.isArray(s))this.updateSuggestions(s,t);else if(i&&i.then){this.suggestionsLoading.value=!0;const e=this.currentPromise=n.makeCancelable(i);e.promise.then(s=>{e===this.currentPromise&&(this.updateSuggestions(s,t),t&&""!==t&&this.suggestions.value&&this.suggestions.value.length>0&&(this.cachedResults[t]=s),this.suggestionsLoading.value=!1)})}}setSuggestions(e,t){this.suggestions.value=e,this.updateIndexTimer&&window.cancelAnimationFrame(this.updateIndexTimer),this.updateIndexTimer=window.requestAnimationFrame(()=>{this.selectedIndex.value=t})}updateSuggestions(e,t){(void 0===t||this.inputElement.current&&i.ObservableLike.getValue(this.props.textValue)===t)&&this.setSuggestions(e,""===i.ObservableLike.getValue(this.props.textValue)?-1:0)}}}("ComponentsIdentityPickerDropdownCustomIdentityPickerDropdown"),h=t.ComponentsIdentityPickerDropdownIdentityPickerDropdown={},Object.defineProperty(t,"__esModule",{value:!0}),t.ComponentsIdentityPickerDropdownIdentityPickerDropdown.IdentityPickerDropdown=(e=>{const[t,n]=i.useObservable(e.value&&i.ObservableLike.getValue(e.value)?i.ObservableLike.getValue(e.value).displayName:""),[o,r]=i.useObservable(!1),{onChange:a}=e;return s.useEffect(()=>{n(e.value&&i.ObservableLike.getValue(e.value)&&i.ObservableLike.getValue(e.value).displayName||"")},[e.value]),s.createElement(p.CustomIdentityPickerDropdown,Object.assign({},e,{suggestionsVisible:o,onChange:e=>!1!==a(e)?(n(e?e.displayName||e.mailNickname:""),!0):(n(""),!1),onInputChange:n,onSuggestionsVisibleChanged:t=>{e.onSuggestionsVisibleChanged&&e.onSuggestionsVisibleChanged(t),r(t)},textValue:t}))}),function(e){g=t[e]={},Object.defineProperty(t,"__esModule",{value:!0});t[e].IdentityPickerDropdownFilterBarItem=class extends t.FilterBarItem.FilterBarItem{constructor(e){super(e),this.selectedUser=new i.ObservableValue(void 0),this.selectedUserFriendlyName=new i.ObservableValue(""),this.areSuggestionsVisible=new i.ObservableValue(!1),this.onFilterChanged=(e=>{super.onFilterChanged(e),e&&e.value||(this.selectedUser.value=void 0,this.setTextValue(""))}),this.onSuggestionsVisibleChanged=(e=>{this.areSuggestionsVisible.value=e}),this.onIdentityChanged=(e=>{this.selectedUser.value=e,this.setFilterValue({value:this.selectedUser.value}),this.setTextValue(e&&e.displayName||"")}),this.setTextValue=(e=>{this.selectedUserFriendlyName.value=e}),e.initialValue&&(i.ObservableLike.isObservable(e.initialValue)?this.selectedUser=e.initialValue:this.selectedUser.value=e.initialValue,this.selectedUserFriendlyName.value=this.selectedUser.value&&this.selectedUser.value.displayName||""),e.initialTextValue&&(i.ObservableLike.isObservable(e.initialTextValue)?this.selectedUserFriendlyName=e.initialTextValue:this.selectedUserFriendlyName.value=e.initialTextValue)}focus(){return!1}render(){return s.createElement(p.CustomIdentityPickerDropdown,{className:t.Util.css(this.props.className,"bolt-identitypicker-filterbaritem"),pickerProvider:this.props.pickerProvider,onChange:this.onIdentityChanged,placeholder:this.props.placeholder,editPlaceholder:this.props.editPlaceholder,value:this.selectedUser,textValue:this.selectedUserFriendlyName,resolveUnrecognizedIdentity:this.props.resolveUnrecognizedIdentity,suggestionsVisible:this.areSuggestionsVisible,onSuggestionsVisibleChanged:this.onSuggestionsVisibleChanged,onInputChange:this.setTextValue})}}}("ComponentsIdentityPickerDropdownIdentityPickerDropdownFilterBarItem"),function(e){function s(s){for(var i in s)t[e].hasOwnProperty(i)||(t[e][i]=s[i])}t[e]={},Object.defineProperty(t,"__esModule",{value:!0}),s(u),s(p),s(h),s(g),s(l)}("IdentityPicker")},["Resources.IdentityPicker","Components/IdentityPickerDropdown/IdentityPickerUtils","Components/IdentityPickerSuggestionsList/IdentityPickerSuggestionItem","Components/IdentityPicker/IdentityPicker","Components/IdentityPickerSuggestionsList/IdentityPickerSuggestionsList","Components/IdentityPickerDropdown/CustomIdentityPickerDropdown","Components/IdentityPickerDropdown/IdentityPickerDropdown","Components/IdentityPickerDropdown/IdentityPickerDropdownFilterBarItem","IdentityPicker"]),document.dispatchEvent(new CustomEvent("scriptLoaded",{cancelable:!1,detail:{id:"ms.vss-features.ui-identity-picker-content"}}));